<div class="familia-page">
    <div class="page-header">
        <div>
            <h1>GestÃ£o de FamÃ­lia ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</h1>
            <p>Gerencie os membros da sua famÃ­lia e compartilhe relatÃ³rios</p>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="section-card" style="text-align: center; padding: 48px;">
        <div style="font-size: 32px; margin-bottom: 16px;">â³</div>
        <p style="color: #6b7280;">Carregando informaÃ§Ãµes da famÃ­lia...</p>
    </div>

    <!-- Criar FamÃ­lia (Exibido se nÃ£o tiver famÃ­lia) -->
    <div *ngIf="!isLoading && !temFamilia" class="section-card create-family-card">
        <h2><span class="icon">ğŸ </span> Criar Nova FamÃ­lia</h2>
        <p style="color: #6b7280; margin-bottom: 24px;">
            VocÃª ainda nÃ£o faz parte de uma famÃ­lia. Crie uma para compartilhar anÃ¡lises e relatÃ³rios com seus
            familiares.
        </p>
        <form [formGroup]="familiaForm" (ngSubmit)="criarFamilia()">
            <div class="form-inline">
                <div class="form-group">
                    <label>Nome da FamÃ­lia</label>
                    <input type="text" formControlName="nome" class="form-input" placeholder="Ex: FamÃ­lia Silva">
                </div>
                <button type="submit" [disabled]="familiaForm.invalid" class="btn btn-primary">
                    âœ¨ Criar FamÃ­lia
                </button>
            </div>
        </form>
    </div>

    <!-- ConteÃºdo quando tem famÃ­lia -->
    <ng-container *ngIf="!isLoading && temFamilia">
        <!-- MÃ©tricas -->
        <div class="metrics-grid">
            <div class="metric-card">
                <div class="metric-icon" style="background: #dbeafe;">ğŸ‘¥</div>
                <div class="metric-value">{{ membros.length }}</div>
                <div class="metric-label">Membros na FamÃ­lia</div>
            </div>
            <div class="metric-card" *ngIf="familyName">
                <div class="metric-icon" style="background: #fef3c7;">ğŸ </div>
                <div class="metric-value" style="font-size: 20px;">{{ familyName }}</div>
                <div class="metric-label">Nome da FamÃ­lia</div>
            </div>
        </div>

        <!-- Lista de Membros -->
        <div class="section-card">
            <h2><span class="icon">ğŸ‘¥</span> Membros da FamÃ­lia</h2>

            <div class="members-grid" *ngIf="membros.length > 0">
                <div *ngFor="let membro of membros" class="member-card">
                    <div class="member-info">
                        <div class="member-avatar">
                            {{ getInitials(membro.nomeCompleto) }}
                        </div>
                        <div class="member-details">
                            <h3>{{ membro.nomeCompleto }}</h3>
                            <p>{{ membro.email }}</p>
                        </div>
                    </div>
                    <div *ngIf="isGestor" class="member-actions">
                        <button [routerLink]="['/minha-familia', membro.id, 'detalhes']" class="btn btn-secondary">
                            ğŸ“Š Detalhes
                        </button>
                        <button (click)="downloadPdf(membro)" class="btn btn-danger">
                            ğŸ“„ PDF
                        </button>
                        <button (click)="downloadExcel(membro)" class="btn btn-success">
                            ğŸ“Š Excel
                        </button>
                    </div>
                </div>
            </div>

            <div class="empty-state" *ngIf="membros.length === 0">
                <div class="icon">ğŸ‘¥</div>
                <p>Nenhum membro na famÃ­lia ainda</p>
            </div>
        </div>

        <!-- Adicionar Membro (Apenas Gestor) -->
        <div *ngIf="isGestor" class="section-card">
            <h2><span class="icon">â•</span> Adicionar Novo Membro</h2>
            <p style="color: #6b7280; margin-bottom: 20px;">
                Adicione um usuÃ¡rio existente Ã  sua famÃ­lia pelo ID dele.
            </p>
            <form [formGroup]="membroForm" (ngSubmit)="adicionarMembro()">
                <div class="form-inline">
                    <div class="form-group">
                        <label>ID do UsuÃ¡rio</label>
                        <input type="number" formControlName="usuarioId" class="form-input"
                            placeholder="Digite o ID do usuÃ¡rio">
                    </div>
                    <button type="submit" [disabled]="membroForm.invalid" class="btn btn-primary">
                        â• Adicionar
                    </button>
                </div>
            </form>
        </div>
    </ng-container>
</div>